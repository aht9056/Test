"use strict";(self["webpackChunkmy_project"]=self["webpackChunkmy_project"]||[]).push([[506],{506:function(t,e,a){a.r(e),a.d(e,{default:function(){return u}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container-fluid layout d-flex flex-column justify-content-center w-100"},[e("div",{staticClass:"d-flex flex-column align-items-center align-content-stretch"},[e("div",{staticClass:"d-flex w-100 justify-content-center"},[e("div",{staticClass:"w-100 d-flex justify-content-evenly"},[e("div",{staticClass:"me-2"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchType,expression:"searchType"}],staticClass:"form-check-input",attrs:{type:"radio",name:"searchTypeRadio",id:"searchTypeRadio_single",value:"single"},domProps:{checked:t._q(t.searchType,"single")},on:{change:[function(e){t.searchType="single"},function(e){t.showTable=!1,t.searchErrorHint=""}]}}),e("label",{staticClass:"form-check-label",attrs:{for:"searchTypeRadio_single"}},[t._v(" 序列號查詢 ")])]),e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchType,expression:"searchType"}],staticClass:"form-check-input",attrs:{type:"radio",name:"searchTypeRadio",id:"searchTypeRadio_muti",value:"muti"},domProps:{checked:t._q(t.searchType,"muti")},on:{change:[function(e){t.searchType="muti"},function(e){t.showTable=!1,t.searchErrorHint=""}]}}),e("label",{staticClass:"form-check-label",attrs:{for:"searchTypeRadio_muti"}},[t._v(" 條件篩選查詢 ")])])])]),e("div",{staticClass:"d-flex w-100 justify-content-center"},[e("article",{directives:[{name:"show",rawName:"v-show",value:"single"===t.searchType,expression:"searchType === 'single'"}],staticClass:"l-design-width w-100"},[e("div",{staticClass:"card row flex-row"},[e("div",{staticClass:"col-2 p-0 d-flex"},[e("el-input",{attrs:{placeholder:"出版社代號(必填)",clearable:""},model:{value:t.serialNumber_1,callback:function(e){t.serialNumber_1=e},expression:"serialNumber_1"}})],1),e("div",{staticClass:"col-2 p-0 d-flex"},[e("span",{staticClass:"ms-1 me-1"},[t._v("_")]),e("el-input",{attrs:{placeholder:"類別代號(必填)",clearable:""},model:{value:t.serialNumber_2,callback:function(e){t.serialNumber_2=e},expression:"serialNumber_2"}})],1),e("div",{staticClass:"col-7 p-0 d-flex"},[e("span",{staticClass:"ms-1 me-1"},[t._v("_")]),e("el-input",{attrs:{type:"number",placeholder:"流水號(必填)",clearable:""},model:{value:t.serialNumber_3,callback:function(e){t.serialNumber_3=e},expression:"serialNumber_3"}})],1),e("div",{staticClass:"col-1 p-0"},[e("button",{staticClass:"search_btn",on:{click:t.checkSingleSerach}},[t._v(" 搜尋 ")])]),e("small",{staticClass:"errorhint"},[t._v(t._s(t.searchErrorHint))])])]),e("article",{directives:[{name:"show",rawName:"v-show",value:"muti"===t.searchType,expression:"searchType === 'muti'"}],staticClass:"l-design-width w-100"},[e("div",{staticClass:"card row flex-row"},[e("div",{staticClass:"col-2 p-0"},[e("el-cascader",{attrs:{options:t.forSaleOption,placeholder:"已/未上架(選填)","popper-class":"orgstructure-cascader",clearable:""},on:{change:t.handleForSaleChange}})],1),e("div",{staticClass:"col-1 p-0"},[e("el-cascader",{attrs:{options:t.languageOption,placeholder:"語言(選填)","popper-class":"orgstructure-cascader",clearable:""},on:{change:t.handleForeignChange}})],1),e("div",{staticClass:"col-3 p-0"},[e("el-cascader",{attrs:{options:t.typeOption,props:t.props,placeholder:"請選擇類型-最多十種(選填)","popper-class":"orgstructure-cascader",clearable:""},on:{change:t.handleTypeChange},model:{value:t.filterWord.type.value,callback:function(e){t.$set(t.filterWord.type,"value",e)},expression:"filterWord.type.value"}})],1),e("div",{staticClass:"col-2 p-0"},[e("el-cascader",{attrs:{options:t.publisherOption,placeholder:"請選擇出版社(選填)","popper-class":"orgstructure-cascader",clearable:""},on:{change:t.handlePublisherChange}})],1),e("div",{staticClass:"col-3 p-0"},[e("el-input",{attrs:{placeholder:"輸入書名關鍵字(選填)",clearable:""},model:{value:t.filterWord.name,callback:function(e){t.$set(t.filterWord,"name",e)},expression:"filterWord.name"}})],1),e("div",{staticClass:"col-1 p-0"},[e("button",{staticClass:"search_btn",on:{click:t.checkFilterWord}},[t._v(" 搜尋 ")])]),e("div",[e("small",{staticClass:"errorhint"},[t._v(t._s(t.searchErrorHint))])])])])])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showTable,expression:"showTable"}],staticClass:"content w-100"},[e("el-table",{staticStyle:{width:"100%","background-color":"transparent"},attrs:{data:t.showData}},[t.dataOutlineLoaded?e("template",{slot:"empty"},[t._v("暫無數據")]):e("template",{slot:"empty"},[t._v("資料載入中...")]),e("el-table-column",{attrs:{prop:"createTime",label:"建單日期",sortable:"",width:"190"}}),e("el-table-column",{attrs:{prop:"serialNumber",label:"流水號",width:"220"}}),e("el-table-column",{attrs:{prop:"name",label:"書籍名稱"}}),e("el-table-column",{attrs:{prop:"forSale",width:"120",label:"已/未上架"},scopedSlots:t._u([{key:"default",fn:function(a){return[1==a.row.forSale?e("span",[e("i",{staticClass:"bi bi-check-circle-fill text-success"}),t._v(" 已上架")]):e("span",[e("i",{staticClass:"bi bi-x-circle-fill text-danger"}),t._v(" 未上架")])]}}])}),e("el-table-column",{attrs:{prop:"type",width:"60",label:"類型"}}),e("el-table-column",{attrs:{width:"230",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"d-flex justify-content-around align-items-center"},[e("div",[e("button",{staticClass:"button_design p-1",attrs:{"data-bs-toggle":"modal","data-bs-target":"#detailDataModal"},on:{click:function(e){return t.showBookDetail(a.$index,a.row)}}},[t._v(" "+t._s("檢視內容")+" ")])]),e("div",[1==a.row.forSale?e("button",{staticClass:"button_design p-1",on:{click:function(e){return t.confirmforSaleStatusUpdate(a.$index,a.row,!1)}}},[t._v(" "+t._s("下架")+" ")]):e("button",{staticClass:"button_design p-1",on:{click:function(e){return t.confirmforSaleStatusUpdate(a.$index,a.row,!0)}}},[t._v(" "+t._s("上架")+" ")])]),e("div",[e("button",{staticClass:"button_design p-1",on:{click:function(t){}}},[t._v(" "+t._s("清除")+" ")])])])]}}])})],2)],1),e("div",{staticClass:"d-flex justify-content-end mt-2"},[e("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.showTable,expression:"showTable"}],attrs:{layout:"prev, pager, next",total:t.tableData.length,"page-size":t.pageNumber,"current-page":t.nowPage},on:{"current-change":t.handlePageChange}})],1),e("div",{staticClass:"modal fade",attrs:{id:"detailDataModal",tabindex:"-1","aria-labelledby":"detailDataModalLabel","aria-hidden":"true","data-bs-backdrop":"static","data-bs-focus":"false"}},[e("div",{staticClass:"modal-dialog modal-lg"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header justify-content-between"},[e("div",[e("h2",{staticClass:"modal-title fs-6",attrs:{id:"detailDataModalLabel"}},[t._v(" "+t._s(t.selectedBookDataOutline.serialNumber)+" ")]),e("div",[e("button",{staticClass:"button_design m-1 p-0 fs-6",class:{selected:"書籍"===t.showDetailType,disabled:"書籍"===t.showDetailType},attrs:{type:"button",disabled:"書籍"===t.showDetailType},on:{click:function(e){t.showDetailType="書籍",t.transitionName="slide-right"}}},[t._v(" 書籍 ")]),e("button",{staticClass:"button_design m-1 p-0 fs-6",class:{selected:"出版"===t.showDetailType,disabled:"出版"===t.showDetailType},attrs:{type:"button"},on:{click:function(e){t.showDetailType="出版",t.transitionName="slide-left"}}},[t._v(" 出版/販售 ")])])]),e("div",[e("button",{staticClass:"close_btn",attrs:{type:"button"},on:{click:function(e){return t.closeModal()}}},[e("i",{staticClass:"bi bi-plus-lg"})])])]),t.dataDetailLoaded?e("div",{staticClass:"modal-body d-flex"},[e("div",{staticClass:"d-flex align-items-center justify-content-center",staticStyle:{width:"5%"}},[e("div",{staticClass:"arrow-btn",class:{disabled:"書籍"===t.showDetailType},on:{click:function(e){t.showDetailType="書籍",t.transitionName="slide-right"}}},[e("i",{staticClass:"bi bi-caret-left-fill"})])]),e("transition-group",{staticStyle:{width:"90%"},attrs:{name:t.transitionName,tag:"div"}},["書籍"===t.showDetailType?e("div",{key:"1",staticStyle:{"overflow-x":"auto"}},[e("table",{staticClass:"table"},[e("tr",[e("th",[t._v("書籍名稱")]),e("td",[t._v(" "+t._s(t.selectedBookDataOutline.name)+" ")])]),e("tr",[e("th",[t._v("語言分類")]),e("td",[t.selectedBookDataOutline.isForeign?[t._v("中文")]:[t._v("外文")]],2)]),e("tr",[e("th",[t._v("主類型")]),e("td",[t._v(" "+t._s(t.typeList[t.selectedBookDataOutline.type].name)+" ")])]),e("tr",[e("th",[t._v("子類型")]),e("td",[t._l(t.selectedBookDataOutline.subTypes,(function(e,a){return[t._v(" "+t._s(e)+" "),a!=t.selectedBookDataOutline.subTypes.length-1?[t._v(" , ")]:t._e()]}))],2)]),e("tr",[e("th",[t._v("書籍標籤")]),e("td",[t._l(t.selectedBookDataOutline.bookTag,(function(e,a){return[t._v(" "+t._s(e)+" "),a!=t.selectedBookDataOutline.bookTag.length-1?[t._v(" , ")]:t._e()]}))],2)]),e("tr",[e("th",[t._v("書籍介紹")]),e("td",{staticClass:"p-1"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.selectedBookDataOutline.description,expression:"\n                                                selectedBookDataOutline.description\n                                            "}],attrs:{readonly:""},domProps:{value:t.selectedBookDataOutline.description},on:{input:function(e){e.target.composing||t.$set(t.selectedBookDataOutline,"description",e.target.value)}}})])]),e("tr",[e("th",[t._v("圖片")]),e("td",{staticClass:"p-1"},[e("table",{staticClass:"w-100",staticStyle:{"background-color":"transparent"}},[e("tr",[e("td",{staticStyle:{border:"none",color:"red"}},[t._v(" 圖一為商品封面 ")])]),t._l(t.rows,(function(a,s){return e("tr",{key:s,staticStyle:{border:"none"}},t._l(a,(function(a,i){return e("td",{key:i,staticClass:"p-1",staticStyle:{border:"none"}},[e("img",{attrs:{src:a,alt:"content page photo"}}),e("div",[t._v(" 圖"+t._s(4*s+i+1)+" ")])])})),0)}))],2)])])])]):t._e(),"出版"===t.showDetailType?e("div",{key:"2",staticStyle:{"overflow-x":"auto"}},[e("table",{staticClass:"table"},[e("tr",[e("th",[t._v("出版社代號")]),e("td",{attrs:{colspan:"5"}},[t._v(" "+t._s(t.selectedBookDataOutline.code)+" ")])]),e("tr",[e("th",[t._v("出版社名稱")]),e("td",{attrs:{colspan:"5"}},[t._v(" "+t._s(t.selectedBookDataOutline.publisherName)+" ")])]),e("tr",[e("th",[t._v("出版日期")]),e("td",{attrs:{colspan:"5"}},[t._v(" "+t._s(t.selectedBookDataOutline.publicationDate)+" ")])]),e("tr",[e("th",[t._v("作者")]),e("td",{attrs:{colspan:"5"}},[t._l(t.selectedBookDataOutline.author,(function(e,a){return[t._v(" "+t._s(e)+" "),a!=t.selectedBookDataOutline.author.length-1?[t._v(" , ")]:t._e()]}))],2)]),e("tr",[e("th",[t._v("作者介紹")]),e("td",{staticClass:"p-1",attrs:{colspan:"5"}},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.bookDataDetail.authorIntro,expression:"\n                                                bookDataDetail.authorIntro\n                                            "}],attrs:{readonly:""},domProps:{value:t.bookDataDetail.authorIntro},on:{input:function(e){e.target.composing||t.$set(t.bookDataDetail,"authorIntro",e.target.value)}}})])]),e("tr",[e("th",[t._v("實體書販售")]),t.selectedBookDataOutline.entity?[e("td",[t._v("有")]),e("td",{staticClass:"title"},[t._v("價格")]),e("td",[t._v(" NT$ "+t._s(t.selectedBookDataOutline.entityPrice)+" ")]),e("td",{staticClass:"title"},[t._v("庫存")]),e("td",[t._v(" "+t._s(t.selectedBookDataOutline.stock)+" 本 ")])]:[e("td",[t._v("無")]),e("td",{staticClass:"title"},[t._v("價格")]),e("td"),e("td",{staticClass:"title"},[t._v("庫存")]),e("td")]],2),e("tr",[e("th",[t._v("電子書販售")]),t.selectedBookDataOutline.ebook?[e("td",[t._v("有")]),e("td",{staticClass:"title"},[t._v("價格")]),e("td",{attrs:{colspan:"3"}},[t._v(" NT$ "+t._s(t.selectedBookDataOutline.ebookPrice)+" ")])]:[e("td",[t._v("無")]),e("td",{staticClass:"title"},[t._v("價格")]),e("td",{attrs:{colspan:"3"}})]],2),e("tr",[e("th",[t._v("最後請求修改訊息")]),e("td",{staticClass:"p-1",attrs:{colspan:"5"}},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.selectedBookDataOutline.fixMessage,expression:"\n                                                selectedBookDataOutline.fixMessage\n                                            "}],attrs:{readonly:""},domProps:{value:t.selectedBookDataOutline.fixMessage},on:{input:function(e){e.target.composing||t.$set(t.selectedBookDataOutline,"fixMessage",e.target.value)}}})])])])]):t._e()]),e("div",{staticClass:"d-flex align-items-center justify-content-center",staticStyle:{width:"5%"}},[e("div",{staticClass:"arrow-btn",class:{disabled:"出版"===t.showDetailType},on:{click:function(e){t.showDetailType="出版",t.transitionName="slide-left"}}},[e("i",{staticClass:"bi bi-caret-right-fill"})])])],1):e("div",{staticClass:"modal-body",staticStyle:{height:"auto"}},[t._m(0)]),t.dataDetailLoaded?e("div",{staticClass:"modal-footer d-flex justify-content-between"},[e("div",[e("button",{staticClass:"button_design p-1",on:{click:function(e){return t.closeModal()}}},[t._v(" 返回 ")])])]):t._e()])])])])},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"loading-overlay"},[e("div",{staticClass:"loading-spinner-container"},[e("div",{staticClass:"loading-spinner"})]),e("div",{staticClass:"loading-text"},[t._v("資料載入中...")])])}],l=(a(4114),a(9470)),r=(a(8704),a(8077)),o={data(){return{searchType:"single",serialNumber_1:"",serialNumber_2:"",serialNumber_3:"",filterWord:{forSale:{isFilter:!1,value:""},isForeign:{isFilter:!1,value:""},publisher:{isFilter:!1,value:""},type:{isFilter:!1,value:[]},name:""},props:{multiple:!0,expandTrigger:"hover"},languageOption:[{value:!1,label:"中文"},{value:!0,label:"外文"}],forSaleOption:[{value:!1,label:"未上架"},{value:!0,label:"已上架"}],typeOption:[],publisherOption:[],searchErrorHint:"",dataOutlineLoaded:!0,certifiedList:[],showTable:!1,nowPage:1,pageNumber:5,bookDataDetail:{},dataDetailLoaded:!1,selectedBookDataOutline:{},showDetailType:"書籍",transitionName:"slide-right",typeList:{}}},computed:{tableData(){return this.certifiedList},showData(){const t=(this.nowPage-1)*this.pageNumber,e=t+this.pageNumber;return this.tableData.slice(t,e)},rows(){const t=4,e=[];for(let a=0;a<this.selectedBookDataOutline.contentPagePhoto.length;a+=t)e.push(this.selectedBookDataOutline.contentPagePhoto.slice(a,a+t));return e}},methods:{getTypeData(){const t=this.$store.state.generalInfo.typeList;this.typeList=this.$store.state.generalInfo.typeList,this.typeOption=Object.keys(t).map((e=>({value:e,label:t[e].name})))},getpublisherData(){const t=this.$store.state.generalInfo.publisherList;this.publisherOption=Object.entries(t).map((([t,e])=>({value:t,label:`${t}-${e}`})))},checkSingleSerach(){if(""==this.serialNumber_1||""==this.serialNumber_2||""==this.serialNumber_3)this.searchErrorHint="請填寫完整序列號";else{let t=`${this.serialNumber_1}_${this.serialNumber_2}_${this.serialNumber_3}`;this.getSingleSearchData(t)}},async getSingleSearchData(t){try{this.dataOutlineLoaded=!1,this.certifiedList=[],this.showTable=!0;const e=await l.A.post("/getDataOutlinebySerialNumber",{serialNumber:t});e.data.success?(this.certifiedList=[e.data.data],this.dataOutlineLoaded=!0):console.error("Failed to getDataDetail:",e.data.message)}catch(e){console.error("Error filterWord:",e)}},handleForSaleChange(t){0==t.length?(this.filterWord.forSale.isFilter=!1,this.filterWord.forSale.value=""):(this.filterWord.forSale.isFilter=!0,this.filterWord.forSale.value=t[0])},handleForeignChange(t){0==t.length?(this.filterWord.isForeign.isFilter=!1,this.filterWord.isForeign.value=""):(this.filterWord.isForeign.isFilter=!0,this.filterWord.isForeign.value=t[0])},handlePublisherChange(t){0==t.length?(this.filterWord.publisher.isFilter=!1,this.filterWord.publisher.value=""):(this.filterWord.publisher.isFilter=!0,this.filterWord.publisher.value=t[0])},handleTypeChange(t){0==t.length?(this.filterWord.type.isFilter=!1,this.filterWord.type.value=[]):t.length>1?(this.filterWord.type.isFilter=!0,this.filterWord.type.value=t.slice(0,10).flat()):(this.filterWord.type.isFilter=!0,this.filterWord.type.value=t.flat())},checkFilterWord(){this.filterWord.forSale.isFilter||this.filterWord.isForeign.isFilter||this.filterWord.publisher.isFilter||this.filterWord.type.isFilter||""!=this.filterWord.name?(this.getSearchCertifiedList(),this.searchErrorHint=""):this.searchErrorHint="請至少填入一項篩選條件"},async getSearchCertifiedList(){try{this.dataOutlineLoaded=!1,this.certifiedList=[],this.showTable=!0;const t=await l.A.post("/getFilterCertifiedList",{filterWord:this.filterWord});t.data.success?(this.certifiedList=t.data.data,this.dataOutlineLoaded=!0):console.error("Failed to getDataDetail:",t.data.message)}catch(t){console.error("Error filterWord:",t)}},confirmforSaleStatusUpdate(t,e,a){let s=a?"上架":"下架";this.$swal.fire({title:`確認${s}`,text:`您確定要${s}該序列號為 ${e.serialNumber} 的商品嗎?`,icon:"warning",showCancelButton:!0,confirmButtonText:"確定",cancelButtonText:"取消",reverseButtons:!0}).then((s=>{s.isConfirmed&&this.$swal.fire({title:"處理中...",text:"正在更新狀態，請稍候",icon:"info",allowOutsideClick:!1,showConfirmButton:!1,cancelButtonText:"取消",didOpen:()=>{this.$swal.showLoading(),this.updateForSaleStatus(t,e,a).then((()=>{this.$swal.close(),this.$swal.fire({title:"成功",text:"資料已成功更新",icon:"success",confirmButtonText:"確定",showCancelButton:!1})})).catch((t=>{this.$swal.close(),this.$swal.fire({title:"錯誤",text:"更新過程中發生錯誤，請稍後重試",icon:"error",confirmButtonText:"確定"}),console.error("Error in update method:",t)}))}})}))},async updateForSaleStatus(t,e,a){try{const s=await l.A.post("/updateForSaleStatus",{serialNumber:e.serialNumber,value:a});s.data.success?this.certifiedList[t].forSale=a:console.error("Failed to getDataDetail:",s.data.message)}catch(s){console.error("Error Data SerialNumber:",s)}},handlePageChange(t){this.nowPage=t},async showBookDetail(t,e){try{const t=await l.A.post("/getBookDataDetailAdmin",{serialNumber:e.serialNumber});t.data.success?(this.bookDataDetail=t.data.data,this.dataDetailLoaded=!0,this.selectedBookDataOutline=e):console.error("Failed to getDataDetail:",t.data.message)}catch(a){console.error("Error Data SerialNumber:",a)}},closeModal(){this.dataDetailLoaded=!1,this.bookDataDetail={},this.selectedBookDataOutline={};var t=document.getElementById("detailDataModal"),e=r.aF.getInstance(t);e.hide()}},beforeMount(){this.getTypeData(),this.getpublisherData()}},n=o,c=a(1656),d=(0,c.A)(n,s,i,!1,null,"24a42364",null),u=d.exports},8704:function(t,e,a){
/*! js-cookie v3.0.5 | MIT */
function s(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var s in a)t[s]=a[s]}return t}a.d(e,{A:function(){return r}});var i={read:function(t){return'"'===t[0]&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function l(t,e){function a(a,i,l){if("undefined"!==typeof document){l=s({},e,l),"number"===typeof l.expires&&(l.expires=new Date(Date.now()+864e5*l.expires)),l.expires&&(l.expires=l.expires.toUTCString()),a=encodeURIComponent(a).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var r="";for(var o in l)l[o]&&(r+="; "+o,!0!==l[o]&&(r+="="+l[o].split(";")[0]));return document.cookie=a+"="+t.write(i,a)+r}}function i(e){if("undefined"!==typeof document&&(!arguments.length||e)){for(var a=document.cookie?document.cookie.split("; "):[],s={},i=0;i<a.length;i++){var l=a[i].split("="),r=l.slice(1).join("=");try{var o=decodeURIComponent(l[0]);if(s[o]=t.read(r,o),e===o)break}catch(n){}}return e?s[e]:s}}return Object.create({set:a,get:i,remove:function(t,e){a(t,"",s({},e,{expires:-1}))},withAttributes:function(t){return l(this.converter,s({},this.attributes,t))},withConverter:function(t){return l(s({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(t)}})}var r=l(i,{path:"/"})}}]);
//# sourceMappingURL=506.1c35cc92.js.map