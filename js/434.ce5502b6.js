"use strict";(self["webpackChunkmy_project"]=self["webpackChunkmy_project"]||[]).push([[434],{6434:function(s,e,t){t.r(e),t.d(e,{default:function(){return d}});var a=function(){var s=this,e=s._self._c;return e("div",{staticClass:"container mt-5 d-flex justify-content-center"},[e("div",{staticClass:"layout"},[e("article",{staticClass:"l-design-width"},[e("div",{staticClass:"card"},[e("h2",[s._v("註冊")]),e("label",{staticClass:"input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:s.displayName,expression:"displayName"}],staticClass:"input__field",attrs:{type:"text",placeholder:""},domProps:{value:s.displayName},on:{blur:s.checkDisplayName,input:function(e){e.target.composing||(s.displayName=e.target.value)}}}),e("span",{staticClass:"input__label"},[s._v("使用者名稱")])]),s._l(this.displayNameError,(function(t){return e("div",[e("small",{staticClass:"errorhint"},[s._v(s._s(t))])])})),e("label",{staticClass:"input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:s.email,expression:"email"}],staticClass:"input__field",attrs:{type:"email",placeholder:""},domProps:{value:s.email},on:{blur:s.checkEmail,input:function(e){e.target.composing||(s.email=e.target.value)}}}),e("span",{staticClass:"input__label"},[s._v("電子信箱")])]),e("small",{staticClass:"errorhint"},[s._v(s._s(this.emailError))]),e("label",{staticClass:"input"},["checkbox"===s.passwordFieldType?e("input",{directives:[{name:"model",rawName:"v-model",value:s.password,expression:"password"}],staticClass:"input__field",attrs:{placeholder:"",type:"checkbox"},domProps:{checked:Array.isArray(s.password)?s._i(s.password,null)>-1:s.password},on:{blur:s.checkPassword,change:function(e){var t=s.password,a=e.target,r=!!a.checked;if(Array.isArray(t)){var i=null,o=s._i(t,i);a.checked?o<0&&(s.password=t.concat([i])):o>-1&&(s.password=t.slice(0,o).concat(t.slice(o+1)))}else s.password=r}}}):"radio"===s.passwordFieldType?e("input",{directives:[{name:"model",rawName:"v-model",value:s.password,expression:"password"}],staticClass:"input__field",attrs:{placeholder:"",type:"radio"},domProps:{checked:s._q(s.password,null)},on:{blur:s.checkPassword,change:function(e){s.password=null}}}):e("input",{directives:[{name:"model",rawName:"v-model",value:s.password,expression:"password"}],staticClass:"input__field",attrs:{placeholder:"",type:s.passwordFieldType},domProps:{value:s.password},on:{blur:s.checkPassword,input:function(e){e.target.composing||(s.password=e.target.value)}}}),e("span",{staticClass:"input__label"},[s._v("密碼")]),e("button",{staticClass:"eye",on:{click:s.togglePasswordFieldType}},["text"===s.passwordFieldType?e("i",{staticClass:"bi bi-eye-fill"}):e("i",{staticClass:"bi bi-eye-slash-fill"})])]),e("small",{staticClass:"errorhint"},[s._v(s._s(this.passwordError))]),e("label",{staticClass:"input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:s.passwordConfirmValue,expression:"passwordConfirmValue"}],staticClass:"input__field",attrs:{type:"password",placeholder:""},domProps:{value:s.passwordConfirmValue},on:{blur:s.passwordConfirm,input:function(e){e.target.composing||(s.passwordConfirmValue=e.target.value)}}}),e("span",{staticClass:"input__label"},[s._v("密碼確認")])]),e("small",{staticClass:"errorhint"},[s._v(s._s(this.passwordconfirmError))]),e("div",{staticClass:"mt-3",staticStyle:{"overflow-x":"auto","overflow-y":"hidden"},attrs:{id:"recaptchaRegister"}}),e("small",{staticClass:"errorhint"},[s._v(s._s(this.recaptchaError))]),e("div",{staticClass:"mt-3"},[e("button",{on:{click:s.register}},[s._v("註冊")])]),s._m(0),e("div",{staticClass:"mt-3"},[e("a",{staticClass:"btn bsb-btn-2xl btn-outline-dark rounded-0 d-flex align-items-center google",attrs:{href:"#!"},on:{click:s.loginWithGoogle}},[e("svg",{staticClass:"bi bi-google text-danger",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"}},[e("path",{attrs:{d:"M15.545 6.558a9.42 9.42 0 0 1 .139 1.626c0 2.434-.87 4.492-2.384 5.885h.002C11.978 15.292 10.158 16 8 16A8 8 0 1 1 8 0a7.689 7.689 0 0 1 5.352 2.082l-2.284 2.284A4.347 4.347 0 0 0 8 3.166c-2.087 0-3.86 1.408-4.492 3.304a4.792 4.792 0 0 0 0 3.063h.003c.635 1.893 2.405 3.301 4.492 3.301 1.078 0 2.004-.276 2.722-.764h-.003a3.702 3.702 0 0 0 1.599-2.431H8v-3.08h7.545z"}})]),e("span",{staticClass:"ms-2 fs-6 flex-grow-1"},[s._v("Google 登入")])])])],2)])])])},r=[function(){var s=this,e=s._self._c;return e("div",{staticClass:"mt-3 d-flex justify-content-center"},[e("span",{staticClass:"line"},[s._v(" 使用其他方式快速登入 ")])])}],i=(t(4114),t(100)),o={data(){return{email:"",password:"",passwordConfirmValue:"",displayName:"",displayNameError:[],emailError:"",passwordError:"",passwordFieldType:"password",passwordconfirmError:"",sitekey:"6LcMlx8qAAAAAEO7Rag1tCQ1LooF2bqer_EN7ITo",myToken:"",recaptchaError:""}},methods:{async register(){try{if(this.checkDisplayName()&this.checkPassword()&this.checkReCAPTCHA()&this.passwordConfirm()&this.checkEmail()){const s=await(0,i.signUpWithEmail)(this.email,this.password,this.displayName);this.$store.state.userInfo.notVerifyUser=s,console.log("驗證信已發送"),this.$router.push("emailverify")}}catch(s){"auth/email-already-in-use"===s.code?this.emailError="※ 該信箱已經被註冊。請檢查您的信箱或嘗試登入。":console.error("註冊錯誤: ",s)}},checkDisplayName(){const s=this.displayName,e=/^(?!.*\s{2,})([a-zA-Z0-9\u4e00-\u9fa5]+(?:\s[a-zA-Z0-9\u4e00-\u9fa5]+)*){1,16}$/;return this.displayNameError=[],0===s.length?(this.displayNameError.push("※ 請填入使用者名稱"),!1):(s.length>16&&this.displayNameError.push("※ 名稱長度不能超過16個字符"),/\s{2,}/.test(s)&&this.displayNameError.push("※ 名稱中不能有連續的空格"),(/\s$/.test(s)||/^\s/.test(s))&&this.displayNameError.push("※ 名稱中不能以空格開頭或結尾"),!!e.test(s)&&(this.displayNameError=[],!0))},checkEmail(){const s=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return""==this.email?(this.emailError="※ 請填入信箱",!1):s.test(this.email)?(this.emailError="",!0):(this.emailError="※ 信箱格式不正確",!1)},checkPassword(){const s=this.password,e=/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,24}$/;return e.test(s)?(this.passwordError="",!0):(this.passwordError="※ 密碼需由8~24個大小寫字母或數字組成，並包含至少一個字母和數字",!1)},passwordConfirm(){return this.passwordConfirmValue===this.password?(this.passwordconfirmError="",!0):(this.passwordconfirmError="※ 兩者密碼不一致，請重新輸入",!1)},checkReCAPTCHA(){return""==this.myToken?(this.recaptchaError="※ 機器人驗證失敗",!1):(this.recaptchaError="",!0)},async loginWithGoogle(){try{const s=await(0,i.signInWithGoogle)();this.$store.state.userInfo.user=s.user,this.saveAccountInfo(this.$store.state.userInfo.user),await this.checkUid(s.user),this.$store.commit("SET_IS_LOGIN",!0),this.$router.push("/home")}catch(s){console.error("登入錯誤: ",s)}},saveAccountInfo(s){Cookies.set("accountInfo",JSON.stringify(s),{expires:7,secure:!1,sameSite:"Strict"}),console.log(Cookies.get("accountInfo"))},async checkUid(){try{const s=await api.post("/checkPermission",{uid:this.$store.state.userInfo.user.uid});s.data.success?(this.result=s.data.exists,Cookies.set("uid",this.$store.state.userInfo.user.uid,{expires:7,secure:!1,sameSite:"Strict"}),Cookies.set("accountPermission",JSON.stringify(this.result),{expires:7,secure:!1,sameSite:"Strict"}),console.log(Cookies.get("accountPermission"))):console.error("Failed to check UID:",s.data.message)}catch(s){console.error("Error checking UID:",s)}},togglePasswordFieldType(){"password"===this.passwordFieldType?this.passwordFieldType="text":this.passwordFieldType="password"},getToken:function(s){this.myToken=s,this.checkReCAPTCHA()},loadReCAPTCHA(){grecaptcha.render(document.getElementById("recaptchaRegister"),{sitekey:this.sitekey,callback:this.getToken})}},created(){},mounted(){this.loadReCAPTCHA()}},l=o,c=t(1656),n=(0,c.A)(l,a,r,!1,null,"376353ec",null),d=n.exports}}]);
//# sourceMappingURL=434.ce5502b6.js.map