{"version":3,"file":"js/887.9d3d4063.js","mappings":"gKAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,yBAAyB,CAACF,EAAG,SAAS,CAACA,EAAG,cAAc,CAAGF,EAAIK,KAAKC,cAA4EN,EAAIO,KAAjEL,EAAG,IAAI,CAACM,YAAY,CAAC,MAAQ,QAAQ,CAACR,EAAIS,GAAG,gBAAyBP,EAAG,IAAI,CAACF,EAAIS,GAAG,SAAST,EAAIU,GAAGV,EAAIK,KAAKM,UAAWX,EAAIK,KAAKC,cAAeJ,EAAG,IAAI,CAACF,EAAIS,GAAG,WAAWT,EAAIO,KAAOP,EAAIK,KAAKC,cAA2KN,EAAIO,KAAhKL,EAAG,WAAW,CAACE,YAAY,YAAYQ,MAAM,CAAC,QAAU,UAAU,SAAWZ,EAAIa,YAAYC,GAAG,CAAC,MAAQd,EAAIe,0BAA0B,CAACf,EAAIS,GAAG,aAAuBT,EAAIa,aAAeb,EAAIK,KAAKC,cAAeJ,EAAG,IAAI,CAACE,YAAY,qBAAqB,CAACJ,EAAIS,GAAG,QAAQT,EAAIU,GAAGV,EAAIgB,cAAc,kBAAkBhB,EAAIO,MAAM,IAAI,IAAI,EACjsB,EACIU,EAAkB,G,mBC4BtB,GACAC,IAAAA,GACA,OACAb,KAAA,KACAM,MAAA,GACAQ,SAAA,GACAC,aAAA,EACAP,YAAA,EACAG,aAAA,GAEA,EACAK,QAAA,CACA,YAAAC,GACA,IACA,KAAAC,sBACA,KAAAC,wBACA,OAAAC,GACA,KAAAL,aAAA,CACA,CACA,EACA,4BAAAI,GACA,KAAAJ,aAAA,EACA,IAAAf,EAAAqB,EAAAA,KAAAC,YACAC,QAAAC,IAAA,eACA,MAAAxB,IAAAA,EAAAC,oBACAD,EAAAyB,SACAzB,EAAAqB,EAAAA,KAAAC,kBACA,IAAAI,SAAAC,GAAAC,WAAAD,EAAA,OAEA3B,GAAAA,EAAAC,gBACAsB,QAAAC,IAAA,SACA,KAAAT,aAAA,EACA,KAAAf,KAAAA,EACA,KAAA6B,OAAAC,MAAAC,SAAA/B,KAAA,KAAAA,KACA,KAAA6B,OAAAC,MAAAC,SAAAC,cAAA,KAEAC,aAAAC,QAAA,WAAAC,KAAAC,UAAAC,OAAArC,OACA,KAAA6B,OAAAS,OAAA,mBACA,KAAAC,QAAAC,KAAA,SAEA,EACA,6BAAA9B,GACA,IACA,KAAAQ,sBACAR,EAAAA,EAAAA,2BACA+B,MAAA,oBACA,OAAArB,GACAG,QAAAH,MAAA,cAAAA,EACA,CACA,EACAF,aAAAA,GACA,KAAAV,YAAA,EACA,KAAAG,aAAA,GACA,MAAA+B,EAAAC,aAAA,KACA,KAAAhC,eACA,KAAAA,cAAA,IACAiC,cAAAF,GACA,KAAAlC,YAAA,EACA,GACA,IACA,GAEAqC,WAAAA,GACA,KAAA7C,KAAA,KAAA6B,OAAAC,MAAAC,SAAAC,cAAAhC,KACA,KAAAiB,QACA,GC/FmQ,I,UCQ/P6B,GAAY,OACd,EACApD,EACAkB,GACA,EACA,KACA,WACA,MAIF,EAAekC,EAAiB,O","sources":["webpack://my_project/./src/views/aboutuser/EmailVerify.vue","webpack://my_project/src/views/aboutuser/EmailVerify.vue","webpack://my_project/./src/views/aboutuser/EmailVerify.vue?10e5","webpack://my_project/./src/views/aboutuser/EmailVerify.vue?f635"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"container mt-5 layout\"},[_c('b-card',[_c('b-card-body',[(!_vm.user.emailVerified)?_c('p',{staticStyle:{\"color\":\"red\"}},[_vm._v(\" 請先驗證您的信箱 \")]):_vm._e(),_c('p',[_vm._v(\"電子信箱: \"+_vm._s(_vm.user.email))]),(_vm.user.emailVerified)?_c('p',[_vm._v(\"驗證成功!\")]):_vm._e(),(!_vm.user.emailVerified)?_c('b-button',{staticClass:\"mt-3 ms-3\",attrs:{\"variant\":\"warning\",\"disabled\":_vm.isCooldown},on:{\"click\":_vm.resendVerificationEmail}},[_vm._v(\"重新發送驗證信\")]):_vm._e(),(_vm.isCooldown && !_vm.user.emailVerified)?_c('p',{staticClass:\"text-warning mt-2\"},[_vm._v(\" 請等待 \"+_vm._s(_vm.cooldownTime)+\" 秒後再次發送驗證信。 \")]):_vm._e()],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"container mt-5 layout\">\r\n        <b-card>\r\n            <b-card-body>\r\n                <p v-if=\"!user.emailVerified\" style=\"color: red\">\r\n                    請先驗證您的信箱\r\n                </p>\r\n                <p>電子信箱: {{ user.email }}</p>\r\n                <p v-if=\"user.emailVerified\">驗證成功!</p>\r\n                <b-button\r\n                    v-if=\"!user.emailVerified\"\r\n                    variant=\"warning\"\r\n                    @click=\"resendVerificationEmail\"\r\n                    :disabled=\"isCooldown\"\r\n                    class=\"mt-3 ms-3\"\r\n                    >重新發送驗證信</b-button\r\n                >\r\n                <p\r\n                    v-if=\"isCooldown && !user.emailVerified\"\r\n                    class=\"text-warning mt-2\"\r\n                >\r\n                    請等待 {{ cooldownTime }} 秒後再次發送驗證信。\r\n                </p>\r\n            </b-card-body>\r\n        </b-card>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { auth, resendVerificationEmail } from '../../login/firebase'\r\nexport default {\r\n    data() {\r\n        return {\r\n            user: null,\r\n            email: '',\r\n            password: '',\r\n            isVerifying: true,\r\n            isCooldown: false,\r\n            cooldownTime: 60,\r\n        }\r\n    },\r\n    methods: {\r\n        async Verify() {\r\n            try {\r\n                this.startCooldown()\r\n                await this.checkEmailVerification()\r\n            } catch (error) {\r\n                this.isVerifying = false\r\n            }\r\n        },\r\n        async checkEmailVerification() {\r\n            this.isVerifying = true\r\n            let user = auth.currentUser\r\n            console.log('進行信箱驗證中....')\r\n            while (user && !user.emailVerified) {\r\n                await user.reload()\r\n                user = auth.currentUser\r\n                await new Promise(resolve => setTimeout(resolve, 2000)) // 每2秒检查一次\r\n            }\r\n            if (user && user.emailVerified) {\r\n                console.log('信箱已驗證')\r\n                this.isVerifying = false\r\n                this.user = user\r\n                this.$store.state.userInfo.user = this.user\r\n                this.$store.state.userInfo.notVerifyUser = null\r\n                //跳轉頁面\r\n                localStorage.setItem('userInfo', JSON.stringify(result.user))\r\n                this.$store.commit('SET_IS_LOGIN', true)\r\n                this.$router.push('/home')\r\n            }\r\n        },\r\n        async resendVerificationEmail() {\r\n            try {\r\n                this.startCooldown()\r\n                await resendVerificationEmail()\r\n                alert('驗證信已重新發送，請檢察您的信箱。')\r\n            } catch (error) {\r\n                console.error('重新發送驗證信錯誤: ', error)\r\n            }\r\n        },\r\n        startCooldown() {\r\n            this.isCooldown = true\r\n            this.cooldownTime = 60\r\n            const interval = setInterval(() => {\r\n                this.cooldownTime--\r\n                if (this.cooldownTime <= 0) {\r\n                    clearInterval(interval)\r\n                    this.isCooldown = false\r\n                }\r\n            }, 1000)\r\n        },\r\n    },\r\n    beforeMount() {\r\n        this.user = this.$store.state.userInfo.notVerifyUser.user\r\n        this.Verify()\r\n    },\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n@import '../../scss/aboutuser/styles.scss';\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./EmailVerify.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./EmailVerify.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./EmailVerify.vue?vue&type=template&id=21995b14&scoped=true\"\nimport script from \"./EmailVerify.vue?vue&type=script&lang=js\"\nexport * from \"./EmailVerify.vue?vue&type=script&lang=js\"\nimport style0 from \"./EmailVerify.vue?vue&type=style&index=0&id=21995b14&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"21995b14\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","user","emailVerified","_e","staticStyle","_v","_s","email","attrs","isCooldown","on","resendVerificationEmail","cooldownTime","staticRenderFns","data","password","isVerifying","methods","Verify","startCooldown","checkEmailVerification","error","auth","currentUser","console","log","reload","Promise","resolve","setTimeout","$store","state","userInfo","notVerifyUser","localStorage","setItem","JSON","stringify","result","commit","$router","push","alert","interval","setInterval","clearInterval","beforeMount","component"],"sourceRoot":""}