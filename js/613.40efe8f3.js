"use strict";(self["webpackChunkmy_project"]=self["webpackChunkmy_project"]||[]).push([[613],{1613:function(e,t,s){s.r(t),s.d(t,{default:function(){return h}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container mt-5 d-flex justify-content-center"},[t("div",{staticClass:"layout"},[t("article",{staticClass:"l-design-width"},[t("div",{staticClass:"card"},[t("h2",[e._v("登入")]),t("label",{staticClass:"input"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.loginEmail,expression:"loginEmail"}],staticClass:"input__field",attrs:{type:"email",placeholder:""},domProps:{value:e.loginEmail},on:{input:function(t){t.target.composing||(e.loginEmail=t.target.value)}}}),t("span",{staticClass:"input__label"},[e._v("電子信箱")])]),t("small",{staticClass:"errorhint"},[e._v(e._s(this.emailError))]),t("label",{staticClass:"input"},["checkbox"===e.passwordFieldType?t("input",{directives:[{name:"model",rawName:"v-model",value:e.loginPassword,expression:"loginPassword"}],staticClass:"input__field",attrs:{placeholder:"",type:"checkbox"},domProps:{checked:Array.isArray(e.loginPassword)?e._i(e.loginPassword,null)>-1:e.loginPassword},on:{change:function(t){var s=e.loginPassword,i=t.target,r=!!i.checked;if(Array.isArray(s)){var o=null,a=e._i(s,o);i.checked?a<0&&(e.loginPassword=s.concat([o])):a>-1&&(e.loginPassword=s.slice(0,a).concat(s.slice(a+1)))}else e.loginPassword=r}}}):"radio"===e.passwordFieldType?t("input",{directives:[{name:"model",rawName:"v-model",value:e.loginPassword,expression:"loginPassword"}],staticClass:"input__field",attrs:{placeholder:"",type:"radio"},domProps:{checked:e._q(e.loginPassword,null)},on:{change:function(t){e.loginPassword=null}}}):t("input",{directives:[{name:"model",rawName:"v-model",value:e.loginPassword,expression:"loginPassword"}],staticClass:"input__field",attrs:{placeholder:"",type:e.passwordFieldType},domProps:{value:e.loginPassword},on:{input:function(t){t.target.composing||(e.loginPassword=t.target.value)}}}),t("span",{staticClass:"input__label"},[e._v("密碼")]),t("button",{staticClass:"eye",on:{click:e.togglePasswordFieldType}},["text"===e.passwordFieldType?t("i",{staticClass:"bi bi-eye-fill"}):t("i",{staticClass:"bi bi-eye-slash-fill"})])]),t("div",{staticClass:"mt-1 d-flex justify-content-between"},[t("small",{staticClass:"errorhint"},[e._v(e._s(this.passwordError))]),t("a",{staticClass:"btn-outline-dark register_link ms-1",on:{click:function(t){return e.goforgetPassword()}}},[e._v(" 忘記密碼")])]),t("div",{staticClass:"mt-1",staticStyle:{"overflow-x":"auto","overflow-y":"hidden"},attrs:{id:"recaptchaLogin"}}),t("small",{staticClass:"errorhint"},[e._v(e._s(this.recaptchaError))]),t("div",{staticClass:"mt-3"},[t("button",{on:{click:e.loginWithEmail}},[e._v("登入")])]),t("div",{staticClass:"mt-3 d-flex"},[t("span",[e._v("還沒有帳號嗎? /")]),t("a",{staticClass:"btn-outline-dark register_link ms-1",on:{click:e.goRegister}},[e._v(" 我要註冊")])]),e._m(0),t("div",{staticClass:"mt-3"},[t("a",{staticClass:"btn bsb-btn-2xl btn-outline-dark rounded-0 d-flex align-items-center google",attrs:{href:"#!"},on:{click:e.loginWithGoogle}},[t("svg",{staticClass:"bi bi-google text-danger",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"}},[t("path",{attrs:{d:"M15.545 6.558a9.42 9.42 0 0 1 .139 1.626c0 2.434-.87 4.492-2.384 5.885h.002C11.978 15.292 10.158 16 8 16A8 8 0 1 1 8 0a7.689 7.689 0 0 1 5.352 2.082l-2.284 2.284A4.347 4.347 0 0 0 8 3.166c-2.087 0-3.86 1.408-4.492 3.304a4.792 4.792 0 0 0 0 3.063h.003c.635 1.893 2.405 3.301 4.492 3.301 1.078 0 2.004-.276 2.722-.764h-.003a3.702 3.702 0 0 0 1.599-2.431H8v-3.08h7.545z"}})]),t("span",{staticClass:"ms-2 fs-6 flex-grow-1"},[e._v("Google 登入")])])])])])])])},r=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"mt-3 d-flex justify-content-center"},[t("span",{staticClass:"line"},[e._v(" 使用其他方式快速登入 ")])])}],o=(s(4114),s(9470)),a=s(8704),n=s(100),l={data(){return{loginEmail:"",loginPassword:"",emailError:"",passwordError:"",passwordFieldType:"password",sitekey:"6LcMlx8qAAAAAEO7Rag1tCQ1LooF2bqer_EN7ITo",myToken:"",recaptchaError:"",mode:"",oobCode:""}},methods:{async loginWithGoogle(){try{const e=await(0,n.signInWithGoogle)();this.$store.state.userInfo.user=e.user,this.saveAccountInfo(this.$store.state.userInfo.user),await this.checkUid(e.user),this.$store.commit("SET_IS_LOGIN",!0),this.$router.push("/home")}catch(e){console.error("登入錯誤: ",e)}},saveAccountInfo(e){a.A.set("accountInfo",JSON.stringify(e),{expires:7,secure:!1,sameSite:"Strict"}),console.log(a.A.get("accountInfo"))},async checkUid(){try{const e=await o.A.post("/checkPermission",{uid:this.$store.state.userInfo.user.uid});e.data.success?(this.result=e.data.exists,a.A.set("uid",this.$store.state.userInfo.user.uid,{expires:7,secure:!1,sameSite:"Strict"}),a.A.set("accountPermission",JSON.stringify(this.result),{expires:7,secure:!1,sameSite:"Strict"})):console.error("Failed to check UID:",e.data.message)}catch(e){console.error("Error checking UID:",e)}},async loginWithEmail(){try{if(this.checkReCAPTCHA()){const e=await(0,n.signInWithEmail)(this.loginEmail,this.loginPassword);e.user.emailVerified?(this.$store.state.userInfo.user=e.user,this.saveAccountInfo(this.$store.state.userInfo.user),await this.checkUid(e.user),this.$store.commit("SET_IS_LOGIN",!0),this.$router.push("/home")):(this.$store.state.userInfo.notVerifyUser=e,alert("請先驗證您的信箱。"),this.$router.push("emailverify"))}}catch(e){this.emailError="",this.passwordError="","auth/user-not-found"===e.code?this.emailError="※ 無效的 Email 地址":"auth/wrong-password"===e.code?this.passwordError="※ 密碼錯誤":console.error("登入錯誤: ",e)}},goRegister(){this.$router.push("register")},togglePasswordFieldType(){"password"===this.passwordFieldType?this.passwordFieldType="text":this.passwordFieldType="password"},getToken:function(e){this.myToken=e,this.checkReCAPTCHA()},loadReCAPTCHA(){grecaptcha.render(document.getElementById("recaptchaLogin"),{sitekey:this.sitekey,callback:this.getToken})},checkReCAPTCHA(){return""==this.myToken?(this.recaptchaError="※ 機器人驗證失敗",!1):(this.recaptchaError="",!0)},goforgetPassword(){this.$router.push("forgetPassword")}},mounted(){this.loadReCAPTCHA()}},c=l,d=s(1656),u=(0,d.A)(c,i,r,!1,null,"3b639f5e",null),h=u.exports},8704:function(e,t,s){
/*! js-cookie v3.0.5 | MIT */
function i(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)e[i]=s[i]}return e}s.d(t,{A:function(){return a}});var r={read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function o(e,t){function s(s,r,o){if("undefined"!==typeof document){o=i({},t,o),"number"===typeof o.expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),s=encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var n in o)o[n]&&(a+="; "+n,!0!==o[n]&&(a+="="+o[n].split(";")[0]));return document.cookie=s+"="+e.write(r,s)+a}}function r(t){if("undefined"!==typeof document&&(!arguments.length||t)){for(var s=document.cookie?document.cookie.split("; "):[],i={},r=0;r<s.length;r++){var o=s[r].split("="),a=o.slice(1).join("=");try{var n=decodeURIComponent(o[0]);if(i[n]=e.read(a,n),t===n)break}catch(l){}}return t?i[t]:i}}return Object.create({set:s,get:r,remove:function(e,t){s(e,"",i({},t,{expires:-1}))},withAttributes:function(e){return o(this.converter,i({},this.attributes,e))},withConverter:function(e){return o(i({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var a=o(r,{path:"/"})}}]);
//# sourceMappingURL=613.40efe8f3.js.map