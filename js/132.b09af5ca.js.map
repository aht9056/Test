{"version":3,"file":"js/132.b09af5ca.js","mappings":"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","sources":["webpack://my_project/./src/views/VuexTry.vue","webpack://my_project/src/views/VuexTry.vue","webpack://my_project/./src/views/VuexTry.vue?6d77","webpack://my_project/./src/views/VuexTry.vue?bbe9"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"container mt-5\"},[(_vm.isVerifying)?_c('b-alert',{attrs:{\"variant\":\"warning\"}},[_vm._v(\" 驗證中... \")]):_vm._e(),(!_vm.user)?_c('b-card',[_c('b-card-body',[_c('b-button',{attrs:{\"variant\":\"primary\"},on:{\"click\":_vm.loginWithGoogle}},[_vm._v(\" 使用 Google 登入 \")])],1)],1):_c('b-card',[_c('b-card-body',[(!_vm.user.emailVerified)?[(!_vm.user.emailVerified)?_c('p',{staticClass:\"text-danger\"},[_vm._v(\" 請先驗證您的信箱 \")]):_vm._e(),_c('p',[_vm._v(\"電子信箱: \"+_vm._s(_vm.user.email))]),(!_vm.user.emailVerified)?_c('b-button',{staticClass:\"mt-3 ms-3\",attrs:{\"variant\":\"warning\",\"disabled\":_vm.isCooldown},on:{\"click\":_vm.resendVerificationEmail}},[_vm._v(\"重新發送驗證信\")]):_vm._e(),(_vm.isCooldown && !_vm.user.emailVerified)?_c('p',{staticClass:\"text-warning mt-2\"},[_vm._v(\" 請等待 \"+_vm._s(_vm.cooldownTime)+\" 秒後再次發送驗證信。 \")]):_vm._e()]:[_c('p',[_vm._v(\"歡迎, \"+_vm._s(_vm.user.displayName))]),_c('p',[_vm._v(\"電子信箱: \"+_vm._s(_vm.user.email))]),(_vm.user.photoURL)?_c('img',{staticClass:\"img-thumbnail\",attrs:{\"src\":_vm.user.photoURL,\"alt\":\"用戶照片\"}}):_vm._e(),_c('b-button',{staticClass:\"mt-3\",attrs:{\"variant\":\"danger\"},on:{\"click\":_vm.logout}},[_vm._v(\"登出\")])]],2)],1),(!_vm.user)?_c('b-card',{staticClass:\"mt-3\"},[_c('b-card-header',[_vm._v(\"註冊\")]),_c('b-card-body',[_c('b-form',{on:{\"submit\":function($event){$event.preventDefault();return _vm.register.apply(null, arguments)}}},[_c('b-form-group',{attrs:{\"label\":\"Email\"}},[_c('b-form-input',{attrs:{\"type\":\"email\",\"required\":\"\"},model:{value:(_vm.email),callback:function ($$v) {_vm.email=$$v},expression:\"email\"}})],1),_c('b-form-group',{attrs:{\"label\":\"Password\"}},[_c('b-form-input',{attrs:{\"type\":\"password\",\"required\":\"\"},model:{value:(_vm.password),callback:function ($$v) {_vm.password=$$v},expression:\"password\"}})],1),_c('b-button',{staticClass:\"mt-3\",attrs:{\"type\":\"submit\",\"variant\":\"success\"}},[_vm._v(\"註冊\")])],1)],1)],1):_vm._e(),(!_vm.user)?_c('b-card',{staticClass:\"mt-3\"},[_c('b-card-header',[_vm._v(\"登入\")]),_c('b-card-body',[_c('b-form',{on:{\"submit\":function($event){$event.preventDefault();return _vm.loginWithEmail.apply(null, arguments)}}},[_c('b-form-group',{attrs:{\"label\":\"Email\"}},[_c('b-form-input',{attrs:{\"type\":\"email\",\"required\":\"\"},model:{value:(_vm.loginEmail),callback:function ($$v) {_vm.loginEmail=$$v},expression:\"loginEmail\"}})],1),_c('b-form-group',{attrs:{\"label\":\"Password\"}},[_c('b-form-input',{attrs:{\"type\":\"password\",\"required\":\"\"},model:{value:(_vm.loginPassword),callback:function ($$v) {_vm.loginPassword=$$v},expression:\"loginPassword\"}})],1),_c('b-button',{staticClass:\"mt-3\",attrs:{\"type\":\"submit\",\"variant\":\"primary\"}},[_vm._v(\"登入\")])],1)],1)],1):_vm._e()],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"container mt-5\">\r\n        <b-alert v-if=\"isVerifying\" variant=\"warning\"> 驗證中... </b-alert>\r\n\r\n        <b-card v-if=\"!user\">\r\n            <b-card-body>\r\n                <b-button variant=\"primary\" @click=\"loginWithGoogle\">\r\n                    使用 Google 登入\r\n                </b-button>\r\n            </b-card-body>\r\n        </b-card>\r\n\r\n        <b-card v-else>\r\n            <b-card-body>\r\n                <template v-if=\"!user.emailVerified\">\r\n                    <p v-if=\"!user.emailVerified\" class=\"text-danger\">\r\n                        請先驗證您的信箱\r\n                    </p>\r\n                    <p>電子信箱: {{ user.email }}</p>\r\n                    <b-button\r\n                        v-if=\"!user.emailVerified\"\r\n                        variant=\"warning\"\r\n                        @click=\"resendVerificationEmail\"\r\n                        :disabled=\"isCooldown\"\r\n                        class=\"mt-3 ms-3\"\r\n                        >重新發送驗證信</b-button\r\n                    >\r\n                    <p\r\n                        v-if=\"isCooldown && !user.emailVerified\"\r\n                        class=\"text-warning mt-2\"\r\n                    >\r\n                        請等待 {{ cooldownTime }} 秒後再次發送驗證信。\r\n                    </p>\r\n                </template>\r\n                <template v-else>\r\n                    <p>歡迎, {{ user.displayName }}</p>\r\n                    <p>電子信箱: {{ user.email }}</p>\r\n                    <img\r\n                        v-if=\"user.photoURL\"\r\n                        :src=\"user.photoURL\"\r\n                        alt=\"用戶照片\"\r\n                        class=\"img-thumbnail\"\r\n                    />\r\n                    <b-button variant=\"danger\" @click=\"logout\" class=\"mt-3\"\r\n                        >登出</b-button\r\n                    >\r\n                </template>\r\n            </b-card-body>\r\n        </b-card>\r\n\r\n        <b-card v-if=\"!user\" class=\"mt-3\">\r\n            <b-card-header>註冊</b-card-header>\r\n            <b-card-body>\r\n                <b-form @submit.prevent=\"register\">\r\n                    <b-form-group label=\"Email\">\r\n                        <b-form-input\r\n                            type=\"email\"\r\n                            v-model=\"email\"\r\n                            required\r\n                        ></b-form-input>\r\n                    </b-form-group>\r\n                    <b-form-group label=\"Password\">\r\n                        <b-form-input\r\n                            type=\"password\"\r\n                            v-model=\"password\"\r\n                            required\r\n                        ></b-form-input>\r\n                    </b-form-group>\r\n                    <b-button type=\"submit\" variant=\"success\" class=\"mt-3\"\r\n                        >註冊</b-button\r\n                    >\r\n                </b-form>\r\n            </b-card-body>\r\n        </b-card>\r\n\r\n        <b-card v-if=\"!user\" class=\"mt-3\">\r\n            <b-card-header>登入</b-card-header>\r\n            <b-card-body>\r\n                <b-form @submit.prevent=\"loginWithEmail\">\r\n                    <b-form-group label=\"Email\">\r\n                        <b-form-input\r\n                            type=\"email\"\r\n                            v-model=\"loginEmail\"\r\n                            required\r\n                        ></b-form-input>\r\n                    </b-form-group>\r\n                    <b-form-group label=\"Password\">\r\n                        <b-form-input\r\n                            type=\"password\"\r\n                            v-model=\"loginPassword\"\r\n                            required\r\n                        ></b-form-input>\r\n                    </b-form-group>\r\n                    <b-button type=\"submit\" variant=\"primary\" class=\"mt-3\"\r\n                        >登入</b-button\r\n                    >\r\n                </b-form>\r\n            </b-card-body>\r\n        </b-card>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n    auth,\r\n    signInWithGoogle,\r\n    signOut,\r\n    signUpWithEmail,\r\n    signInWithEmail,\r\n    resendVerificationEmail,\r\n    addUserInfo,\r\n} from '../login/firebase'\r\nexport default {\r\n    data() {\r\n        return {\r\n            user: null,\r\n            email: '',\r\n            password: '',\r\n            loginEmail: '',\r\n            loginPassword: '',\r\n            phone: '',\r\n            verificationCode: '',\r\n            verificationId: null,\r\n            isVerifying: false,\r\n            isCooldown: false,\r\n            cooldownTime: 60,\r\n        }\r\n    },\r\n    methods: {\r\n        async loginWithGoogle() {\r\n            try {\r\n                const result = await signInWithGoogle()\r\n                this.user = result.user\r\n            } catch (error) {\r\n                console.error('登录错误: ', error)\r\n            }\r\n        },\r\n        async logout() {\r\n            try {\r\n                await signOut()\r\n                this.user = null\r\n                sessionStorage.clear()\r\n            } catch (error) {\r\n                console.error('登出错误: ', error)\r\n            }\r\n        },\r\n        async register() {\r\n            try {\r\n                const result = await signUpWithEmail(this.email, this.password)\r\n                this.user = result.user\r\n                console.log('驗證信已發送')\r\n\r\n                this.isVerifying = true\r\n                this.startCooldown()\r\n                await this.checkEmailVerification()\r\n            } catch (error) {\r\n                if (error.code === 'auth/email-already-in-use') {\r\n                    alert('該信箱已經被註冊。請檢查您的信箱或嘗試登入。')\r\n                } else {\r\n                    console.error('註冊錯誤: ', error)\r\n                }\r\n                this.isVerifying = false\r\n            }\r\n        },\r\n        async loginWithEmail() {\r\n            try {\r\n                // Step 1: 登录\r\n                const result = await signInWithEmail(\r\n                    this.loginEmail,\r\n                    this.loginPassword,\r\n                )\r\n                this.user = result.user\r\n\r\n                // Step 2: 检查邮箱验证状态\r\n                if (!this.user.emailVerified) {\r\n                    this.isVerifying = true\r\n                    alert('請先驗證您的信箱。')\r\n                    await this.checkEmailVerification()\r\n                }\r\n            } catch (error) {\r\n                console.error('登入錯誤: ', error)\r\n            }\r\n        },\r\n        async checkEmailVerification() {\r\n            this.isVerifying = true\r\n            let user = auth.currentUser\r\n            console.log('進行信箱驗證中....')\r\n            while (user && !user.emailVerified) {\r\n                await user.reload()\r\n                user = auth.currentUser\r\n                await new Promise(resolve => setTimeout(resolve, 2000)) // 每2秒检查一次\r\n            }\r\n            if (user && user.emailVerified) {\r\n                this.isVerifying = false\r\n                this.user = user\r\n                console.log('信箱以驗證')\r\n                this.test()\r\n            }\r\n        },\r\n        async resendVerificationEmail() {\r\n            try {\r\n                this.startCooldown()\r\n                await resendVerificationEmail()\r\n                alert('驗證信已重新發送，請檢察您的信箱。')\r\n            } catch (error) {\r\n                console.error('重新發送驗證信錯誤: ', error)\r\n            }\r\n        },\r\n        startCooldown() {\r\n            this.isCooldown = true\r\n            this.cooldownTime = 60\r\n            const interval = setInterval(() => {\r\n                this.cooldownTime--\r\n                if (this.cooldownTime <= 0) {\r\n                    clearInterval(interval)\r\n                    this.isCooldown = false\r\n                }\r\n            }, 1000)\r\n        },\r\n        async test() {\r\n            try {\r\n                let infoData = {\r\n                    email: this.user.email,\r\n                }\r\n                await addUserInfo(this.user.uid, infoData)\r\n            } catch (error) {\r\n                console.error(error)\r\n            }\r\n        },\r\n    },\r\n    created() {},\r\n}\r\n</script>\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./VuexTry.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./VuexTry.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./VuexTry.vue?vue&type=template&id=34b45d60\"\nimport script from \"./VuexTry.vue?vue&type=script&lang=js\"\nexport * from \"./VuexTry.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","isVerifying","attrs","_v","_e","user","emailVerified","_s","displayName","email","photoURL","on","logout","isCooldown","resendVerificationEmail","cooldownTime","loginWithGoogle","$event","preventDefault","register","apply","arguments","model","value","callback","$$v","expression","password","loginWithEmail","loginEmail","loginPassword","staticRenderFns","data","phone","verificationCode","verificationId","methods","result","signInWithGoogle","error","console","signOut","sessionStorage","clear","signUpWithEmail","log","startCooldown","checkEmailVerification","code","alert","signInWithEmail","auth","currentUser","reload","Promise","resolve","setTimeout","test","interval","setInterval","clearInterval","infoData","addUserInfo","uid","created","component"],"sourceRoot":""}